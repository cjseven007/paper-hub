<div class="relative flex h-full flex-col gap-6 bg-white">
  @if(answersLoading()){
  <div class="flex h-full items-center justify-center">
    <span
      class="h-8 w-8 animate-spin rounded-full border-2 border-zinc-300 border-t-zinc-900"
    ></span>
  </div>
  }@else {
  <!-- Header -->
  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-xl font-semibold text-zinc-900">My Workspace</h1>
      <p class="text-sm text-zinc-500">Your saved answer sheets for past-year exam questions.</p>
    </div>
  </div>

  <!-- Grid -->
  <div class="flex-1 rounded-xl border border-zinc-200 bg-zinc-50 p-4 mb-5">
    @if (answerDocs().length === 0) {
    <div class="flex h-full flex-col items-center justify-center text-center text-sm text-zinc-500">
      <p>No answer sheets yet.</p>
      <p>
        Go to <span class="font-medium">Contribute paper</span> and save questions to your
        workspace.
      </p>
    </div>
    } @else {
    <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4">
      @for (a of answerDocs(); track a.id) {
      <app-answer-card
        [answer]="a"
        [deleting]="deletingId() === a.id"
        (cardClick)="openAnswer(a)"
        (deleteClick)="requestDelete(a)"
      ></app-answer-card>
      }
    </div>
    }
  </div>

  @if (error()) {
  <p class="text-sm text-red-500">{{ error() }}</p>
  } }

  <!-- Delete confirmation modal -->
  @if (showDeleteDialog() && deleteTarget()) {
  <div class="fixed inset-0 z-40 flex items-center justify-center bg-black/30 backdrop-blur-sm">
    <div class="w-full max-w-md rounded-2xl bg-white p-5 shadow-xl">
      <div class="mb-3 flex items-start justify-between gap-3">
        <div>
          <h3 class="text-sm font-semibold text-zinc-900">Delete answer set?</h3>
          <p class="mt-1 text-xs text-zinc-600">
            This will permanently remove this answer set from your workspace. This action cannot be
            undone.
          </p>
        </div>
        <button
          type="button"
          (click)="closeDeleteDialog()"
          class="flex h-7 w-7 items-center justify-center rounded-full border border-zinc-200 text-zinc-500 hover:bg-zinc-50"
        >
          <svg viewBox="0 0 24 24" class="h-3.5 w-3.5">
            <path
              fill="currentColor"
              d="M18.3 5.7 12 12l6.3 6.3-1.4 1.4L10.6 13.4 4.3 19.7 2.9 18.3 9.2 12 2.9 5.7 4.3 4.3 10.6 10.6 16.9 4.3z"
            />
          </svg>
        </button>
      </div>

      <div class="mt-4 flex justify-end gap-2">
        <button
          type="button"
          (click)="closeDeleteDialog()"
          class="rounded-lg border border-zinc-200 px-3 py-1.5 text-xs font-medium text-zinc-700 hover:bg-zinc-50"
        >
          Cancel
        </button>
        <button
          type="button"
          (click)="confirmDeleteAnswer()"
          class="rounded-lg bg-red-600 px-4 py-1.5 text-xs font-medium text-white hover:bg-red-700"
        >
          Delete
        </button>
      </div>
    </div>
  </div>
  }
</div>
